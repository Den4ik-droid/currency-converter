# Конвертер валют — Backend

Бэкенд‑приложение для конвертации валют. Служит прослойкой между клиентским приложением и внешним API Frankfurter, обеспечивая кэширование, хранение пользовательских настроек и оптимизацию запросов.

## Стек технологий

- Node.js + Express
- TypeScript
- Supabase
- Swagger
- Docker Compose
- Prettier

## Реализованный функционал

### Авторизация

- Генерация `user_id` через httpOnly cookie
- Middleware `userIdCookie` для автоматической идентификации пользователя

### Пользователь

- `GET /api/user` — получение настроек пользователя
- `POST /api/user` — обновление настроек
- Настройки хранятся в Supabase

### Валюты

- `GET /api/currencies`
    - получение списка валют
    - кэширование на **1 час** в памяти

### Курсы валют

- `GET /api/rates?base=USD&targets=EUR,GBP`
- Логика:
    - если `base` не указана — используется валюта из настроек пользователя
    - обязательный параметр `targets`
- Кэширование:
    - **5 минут** — в памяти (per‑user)
    - **24 часа** — в базе данных (Supabase)
- Запрос к Frankfurter API выполняется только при отсутствии данных в кэше

### Архитектура

- Контроллеры
- Вся бизнес‑логика вынесена в сервисы
- Разделение уровней кэширования:
    - `ratesCache.service.ts` — память
    - `ratesDbCache.service.ts` — Supabase

### Дополнительно

- `.env.example` для конфигурации
- `.nvmrc`, ESLint, Prettier
- Docker Compose для быстрого запуска
- Swagger‑документация по адресу: **/api/docs**
- Папка `demo/` с примерами запросов
